
/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"33C5DB17-0276-44F6-BA23-C528D13B7637"}
 */
var	vl_turno_naranja
/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"ADD3146C-1FE6-4A66-8B26-B5B392EA7157"}
 */
var	vl_turno_celeste
/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"CB316D5E-CFE6-42BE-8A98-11849F490719"}
 */
var	vl_turno_violeta
/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"8088BC82-1A89-48C2-8830-1FC729D22F3F"}
 */
var	vl_turno_fuxia

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A907E308-4839-4810-BFAA-E7D483EA0062"}
 */
var vl_turno_rosado = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"463336B0-F742-4748-9556-A5CB59DD4717"}
 */
var vl_turno_gris = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"9A6B8D10-E786-4A1F-A039-511B909EDC7B"}
 */
var vl_turno_rojo = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A1C53D56-D62E-4F5F-998C-6F5F1F204825"}
 */
var vl_turno_amarillo = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"4B6D5234-AFA3-4B83-88F5-551EA2C9E656"}
 */
var vl_turnos_verde = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"6062E0CC-6F40-4DA3-815B-0A8EF039F464"}
 */
var vl_borde = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"EC42EFB4-4410-458C-9C30-6ED0CE8FDB17"}
 */
var vl_dia_31 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"16BB7BBC-D7B3-414B-86C4-2C353A20D430"}
 */
var vl_dia_30 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"060D2646-281B-4A8F-BDD5-96337DC1843D"}
 */
var vl_dia_29 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2F5DA2D3-3147-47D5-B1FC-AF7D76E4FB57"}
 */
var vl_dia_28 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"6BA9A136-93D3-485E-84E1-19E8DD00167F"}
 */
var vl_dia_27 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"E972226B-92C3-4A91-84B7-C97A36E91CC5"}
 */
var vl_dia_26 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"BF9A23B5-F0E1-4B1D-B327-46F43807CAF8"}
 */
var vl_dia_25 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"F7D5A140-79B6-4CC8-8A80-18AB2C97E3A6"}
 */
var vl_dia_24 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"C95A54CF-BDCB-4249-8E25-4A62E64745A9"}
 */
var vl_dia_23 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"172812DD-7B2A-4046-8B0D-AA6B66E0AD6E"}
 */
var vl_dia_22 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"3FDC6A93-8717-4783-804D-9D3EAEE36B49"}
 */
var vl_dia_21 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"9709C7FB-C136-43C0-A469-23606676AA45"}
 */
var vl_dia_20 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"CF3FE57E-9AC6-4877-AF2C-4A60F318F037"}
 */
var vl_dia_19 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"B9CA770D-F3DD-4BED-9872-3EE02A3FD24C"}
 */
var vl_dia_18 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"7D489F39-4248-424C-9B80-181B284C661C"}
 */
var vl_dia_17 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"A257AA96-4A64-4250-97F5-726E5AE60962"}
 */
var vl_dia_16 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"19D261AC-F0E1-416D-959B-1508DACC79E0"}
 */
var vl_dia_15 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"4F3BA0C7-6210-4FEE-A0EE-13F70D8C68DF"}
 */
var vl_dia_14 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"74CE055A-2B20-46A7-BF51-7EA1AFE917A9"}
 */
var vl_dia_13 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"94F5575F-A734-4D6A-A861-5A62E647D889"}
 */
var vl_dia_12 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"D88F5DC0-87BC-44BB-B1A5-4948B208F3FA"}
 */
var vl_dia_11 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"D2B7FC03-24B2-40C7-95E6-B28E18A58F98"}
 */
var vl_dia_10 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"9E6FB0B7-CE53-4027-B7CD-8CA81DDDD5F4"}
 */
var vl_dia_9 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"3DAEBBB4-8FF3-40EE-A989-04A20C644FF1"}
 */
var vl_dia_8 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"DA7B259F-AE6C-4967-B8F5-CC1D989D57A3"}
 */
var vl_dia_7 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"DF31E5BF-ED9A-4A99-B7B7-3694F503FB53"}
 */
var vl_dia_6 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"FF029837-65C5-406A-8AFC-08988DA7548F"}
 */
var vl_dia_5 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"16BBB6AB-202C-44BD-8307-B4D2F1C79D15"}
 */
var vl_dia_4 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2D5F0251-78FD-4937-8662-0F60234D7C2E"}
 */
var vl_dia_3 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"7A7E86CC-5515-46C1-97DA-FAEED894977C"}
 */
var vl_dia_2 = null;

/**
 * @type {String}
 *
 * @properties={typeid:35,uuid:"2017F05B-0D20-4F40-A46F-7BE735735342"}
 */
var vl_dia_1 = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"EF46240D-03E9-40DA-A529-44E16C7B8EFC",variableType:4}
 */
var vl_anio = null;

/**
 * @type {Number}
 *
 * @properties={typeid:35,uuid:"A422A1C4-02F0-4851-ADD0-8FB1542BB375",variableType:4}
 */
var vl_mes = null;

/**
 * Callback method for when form is shown.
 *
 * @param {Boolean} firstShow form is shown first time after load
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"BA4587D2-C90E-477C-BAA7-5FF8299807E8"}
 * @AllowToRunInFind
 */
function onShow(firstShow, event) 
{
	if(firstShow)
	{	
		vl_anio = application.getServerTimeStamp().getFullYear()
		vl_mes = application.getServerTimeStamp().getMonth() + 1
		filtrar()
	}

	vl_turnos_verde = '#97ff97' 
	vl_turno_amarillo = '#ffff80'
	vl_turno_rojo = '#ff8888'
	vl_turno_gris = '#c0c0c0' //No atiende
	vl_turno_rosado = '#ff80ff' // Feriado
	vl_turno_naranja = '#ff9f71' // Vacaciones
	vl_turno_celeste = '#80ffff' //Cursos y Congresos
	vl_turno_violeta =	'#9e9ecf' // Franco/Licencia
	vl_turno_fuxia = '#f900f9' // No Laborable
		
	vl_borde = 'LineBorder,2,#000000'

	
}

/**
 * @properties={typeid:24,uuid:"E3088E20-21B3-49AF-A0DE-0A29809338DF"}
 * @AllowToRunInFind
 */
function filtrar() 
{
	controller.find()
	cal_turno_mes = vl_mes
	cal_turno_anio = vl_anio
	controller.search()
	setDias()
}

/**
 * Called before the form component is rendered.
 *
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"5A88CBB1-8684-4D97-AEEF-E3CAD2E5BB5D"}
 */
function onRender1(event) 
{

	render(1,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"4388BEEB-83F8-45F3-9A61-2307C43620F0"}
 */
function onRender2(event) 
{
	render(2,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"6422536D-6D98-4799-B56A-558A6EFEA9E2"}
 */
function onRender3(event) 
{
	render(3,event)
}

/**
  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"81C63F6A-0FD7-4024-97DF-891CA2248EED"}
 */
function onRender4(event) 
{
	render(4,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"3A0A9561-7406-4707-9F5F-0E528CB641E3"}
 */
function onRender5(event) 
{
	render(5,event)
}

/**
  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"BD6C2BFD-9280-44E6-8922-87BAF104B942"}
 */
function onRender6(event) 
{
	render(6,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"BC900EBC-833B-4AEE-8E82-EE98560FD188"}
 */
function onRender7(event) 
{
	render(7,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"CA72585D-28B6-4258-AF70-C1F7C7FEDFB1"}
 */
function onRender8(event) 
{
	render(8,event)
}

/**

  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"3B35E4D6-A668-4675-90B6-1C06F79E827C"}
 */
function onRender9(event) 
{
	render(9,event)
}

/**
  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"BD1992FF-D30C-449A-8D5B-942B0689AE12"}
 */
function onRender10(event) 
{
	render(10,event)
}

/**
  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"E8A791C0-4A6C-4942-8128-C93E97474D30"}
 */
function onRender11(event) 
{
render(11,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"F3F97E1F-E482-4B33-A1F8-856619F09FAE"}
 */
function onRender12(event) 
{
	render(12,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"46E3ED43-63F3-45E1-B695-422F835B74A2"}
 */
function onRender13(event) 
{
	render(13,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"93AC8136-F9C1-47BE-9650-43F33B0E4F17"}
 */
function onRender14(event) 
{
	render(14,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"9EC277DB-B9F8-4F4C-9C19-B0F8368036E6"}
 */
function onRender15(event) 
{
	render(15,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"B962CBD9-B251-4122-8516-C3B59B341775"}
 */
function onRender16(event) 
{
	render(16,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"4B1F4FF8-6CD4-49C7-AABF-AC9B4D4CBCC2"}
 */
function onRender17(event) 
{
	render(17,event)
}

/**
   * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"60780A77-D62D-4A91-B0DB-EB697B58AEAA"}
 */
function onRender18(event) 
{
	render(18,event)
}

/**
  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"7EF9254A-29B7-4A35-8F75-E7A2C539B7CB"}
 */
function onRender19(event) 
{
	render(19,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"C59A9A40-2722-43D8-9868-B7162DB5BDF6"}
 */
function onRender20(event) 
{
	render(20,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"7B278F5F-6D03-48EC-B1C5-D19BADE0CF56"}
 */
function onRender21(event) 
{
	render(21,event)
}

/**
  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"F2C1412C-6255-4B60-862F-0F1C1AB0AAE3"}
 */
function onRender22(event) 
{
	render(22,event)
}

/**

 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"0E378560-A28F-4150-A2CF-322490EF27EC"}
 */
function onRender23(event) 
{
	render(23,event)
}

/**
 * 
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"68314A67-E090-46D2-8A2F-BF32954BEA58"}
 */
function onRender24(event) 
{
	render(24,event)
}

/**
  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"4CC686BF-0B2D-44DE-A2E9-1007470A1D69"}
 */
function onRender25(event) 
{
	render(25,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"3CD3DAF7-9680-4C69-B44B-80D2ECE23A31"}
 */
function onRender26(event) 
{
	render(26,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"95FAD0D9-0367-47D6-BD60-92E58DD38279"}
 */
function onRender27(event) 
{
	render(27,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"5C3CEDF1-4157-458C-AE79-3F05FB6A58FE"}
 */
function onRender28(event) 
{
	render(28,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"3B63E942-0353-49A7-BC57-143D362AEFF6"}
 */
function onRender29(event) 
{
	render(29,event)
}

/**
  * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"D0ABD162-9F03-47C8-8173-0EBD5E840A43"}
 */
function onRender30(event) 
{
	render(30,event)
}

/**
 * @param {JSRenderEvent} event the render event
 *
 * @properties={typeid:24,uuid:"E6E97537-A4EA-4EF4-BFDF-AE1E687FCF2F"}
 */
function onRender31(event) 
{
	render(31,event)
}

/**

 * @private
 *
 * @properties={typeid:24,uuid:"6C82F91F-6B1F-47C1-8BC2-B6003E9A3680"}
 * @AllowToRunInFind
 */
function existeAsistencia(id, mes, anio) 
{
	/** @type {JSFoundset<db:/sistemas/cli_turno_calendario>}*/
	var fs_cal = databaseManager.getFoundSet('sistemas','cli_turno_calendario')
	fs_cal.find()
	fs_cal.medico_id = id
	fs_cal.cal_turno_mes = mes
	fs_cal.cal_turno_anio = anio
	var cant = fs_cal.search()
	if(cant > 0)
	{
		return true
	}
	return false
}

/**
 * @properties={typeid:24,uuid:"5FFF49E5-4D34-437D-95AC-6F3F719F58B9"}
 */
function generarPlanilla() 
{
	application.updateUI()
	
	/** @type {JSFoundset<db:/sistemas/medico>}*/
	var fs_med = databaseManager.getFoundSet('sistemas','medico')
	fs_med.loadAllRecords()
	
	for(var i=1;i<=fs_med.getSize();i++)
	{
		
		var myRecord = fs_med.getRecord(i)
		if(!existeAsistencia(myRecord.medico_id,vl_mes,vl_anio))
		{	
			controller.newRecord()
			empresa_id = 1
			medico_id = myRecord.medico_id
			cal_turno_mes = vl_mes
			cal_turno_anio = vl_anio
			for(var j=1;j<=scopes.globals.ultimoDiaMes(vl_mes,vl_anio);j++)
			{
				var nombre = 'cal_turno_id_' + j
				foundset[nombre] = verDiaDisponible(j,vl_mes,vl_anio,myRecord.medico_id)
			}
			databaseManager.saveData(foundset)
		}	
	}
	filtrar()
	plugins.busy.unblock()
}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"35D26EB9-09FB-43FB-9073-10E0E6D9A10D"}
 */
function onActionVolver(event) 
{
	scopes.globals.CargarMenu()
	forms['clinica_inicio_clinica'].controller.show()
}

/**

 * @private
 *
 * @properties={typeid:24,uuid:"CAA1197F-2D1F-42F4-9661-2B4EE24B12B1"}
 */
function setDias() 
{
	forms.cli_turnos_calendario['vl_dia_29'] = ''
	forms.cli_turnos_calendario['vl_dia_30'] = ''
	forms.cli_turnos_calendario['vl_dia_31'] = ''		
	var fecha = new Date()
	var dias = 31
	if(vl_mes == 4 || vl_mes == 6 || vl_mes == 9 || vl_mes == 11)
	{
		dias = 30
	}
	if(vl_mes == 2)
	{
		dias = 28
		 var bisiesto = ((vl_anio % 4 == 0) && ((vl_anio % 100 != 0) || (vl_anio % 400==0)))
		 if(bisiesto)
		 {
			dias = 29
		 }
	}
	/**@type {String}*/	
	var lbl = null
	for(var i=1; i<=dias;i++)
	{
		fecha = new Date(vl_anio,(vl_mes - 1),i)

		lbl = 'vl_dia_' + i
		var day = fecha.getDay()
		switch (day) 
		{
		case 0:
		forms.cli_turnos_calendario[lbl] = i + '-Do'
		//elements[lbl].bgcolor = '#9a9a9a'
		break;			
		case 1:
		forms.cli_turnos_calendario[lbl] = i + '-Lu'
		//elements[lbl].bgcolor = '#666666'			
			break;
		case 2:
		forms.cli_turnos_calendario[lbl] = i + '-Ma'
		//elements[lbl].bgcolor = '#666666'			
		break;
		case 3:
		forms.cli_turnos_calendario[lbl] = i + '-Mi'
		//elements[lbl].bgcolor = '#666666'			
		break;
		case 4:
		forms.cli_turnos_calendario[lbl] = i + '-Ju'
		//elements[lbl].bgcolor = '#666666'			
		break;
		case 5:
		forms.cli_turnos_calendario[lbl] = i + '-Vi'
		//elements[lbl].bgcolor = '#666666'			
		break;
		case 6:
		forms.cli_turnos_calendario[lbl] = i + '-Sa'
		//elements[lbl].bgcolor = '#666666'			
		break;
		}
	}
}




/**
 * Perform the element right-click action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"C2895BC7-DD39-4B98-95F2-B5B41E781CF2"}
 */
function onRightClick(event) 
{
	var menu = plugins.window.createPopupMenu();

	var item1 = menu.addMenuItem("Ver Turnos del Dia",verDia,"media:///16x16/zoom.png",null);
	var item2 = menu.addMenuItem("Habilitar Dia",habilitarDia,"media:///16x16/add.png",null);
	var item3 = menu.addMenuItem("Dehabilitar Dia",deshabilitarDia,"media:///16x16/cancel.png",null);	
	item1.methodArguments = [event.getElementName()]
	item2.methodArguments = [event.getElementName()]
	item3.methodArguments = [event.getElementName()]
	var dato = foundset.getSelectedRecord()[event.getElementName()]
	if(dato == 'NA'||dato == 'FE'||dato == 'VA'||dato == 'CC'||dato == 'NL'||dato == 'FL')
	{
		item1.enabled = false
		item2.enabled = true
		item3.enabled = false
	}
	else
	{
		item1.enabled = true
		item2.enabled = false
		item3.enabled = true		
	}
	menu.show()
}

/**
 * TODO generated, please specify type and doc for the params
 * @param dia
 * @param {JSRenderEvent} event the render event
 * @properties={typeid:24,uuid:"911B61AF-9057-4B2B-A750-128521D2D912"}
 */
function render(dia, event)
{
	/** @type {JSRecord<db:/sistemas/cli_turno_calendario>}*/	
	var record = event.getRecord()
	var nombre = 'cal_turno_id_' + dia
	{
		event.getRenderable().bgcolor = '#ffffff'

		if(record[nombre] > 10 && record[nombre]!=null)
		{
			event.getRenderable().bgcolor = vl_turnos_verde
		}
		if(record[nombre] < 10 && record[nombre]!=null)
		{
			event.getRenderable().bgcolor = vl_turno_amarillo
		}
		if(record[nombre] == 0 && record[nombre]!=null)
		{
			event.getRenderable().bgcolor = vl_turno_rojo
		}
		if(record[nombre] == 'NA')
		{		
			event.getRenderable().bgcolor = vl_turno_gris		
		}
		if(record[nombre] == 'FE')
		{		
			event.getRenderable().bgcolor = vl_turno_rosado		
		}
		if(record[nombre] == 'VA')
		{		
			event.getRenderable().bgcolor = vl_turno_naranja		
		}
		if(record[nombre] == 'CC')
		{		
			event.getRenderable().bgcolor = vl_turno_celeste		
		}
		if(record[nombre] == 'NL')
		{		
			event.getRenderable().bgcolor = vl_turno_fuxia		
		}
		if(record[nombre] == 'FL')
		{		
			event.getRenderable().bgcolor = vl_turno_violeta		
		}		
		var borde = event.getRenderable().border
		var fecha = new Date(vl_anio, vl_mes - 1, dia)
		switch (fecha.getDay()) 
		{
		case 0:
			event.getRenderable().border = vl_borde	
			break;
		case 6:
		event.getRenderable().border = vl_borde	
		break;		
		default:
		event.getRenderable().border = borde		
			break;
		}
		event.getRenderable().fgcolor = '#000000'
	}
	
}

/**
 * @properties={typeid:24,uuid:"5D9B4942-8C0D-4F36-8A3E-7CA434823FE2"}
 */
function verDia()
{
	/**@type {String}*/
	var dia = arguments[5]
	/**@type {Array<String>}*/
	var separator = dia.split('_')
	var diaNumber = utils.stringToNumber(separator[3])
	forms.cli_turnos_lst_x_dia.foundset.clear()
	forms.cli_turnos_lst_x_dia.limpiarCantidades()
	forms.cli_turnos_lst_x_dia.vl_cli_turno_id = foundset.getSelectedRecord().cal_turno_id
	forms.cli_turnos_lst_x_dia.vl_dia = new Date(vl_anio,vl_mes - 1,diaNumber)
	forms.cli_turnos_lst_x_dia.vl_medico = foundset.getSelectedRecord().medico_id
	forms.cli_turnos_lst_x_dia.controller.show()	
}

/**
 * @properties={typeid:24,uuid:"7C14489E-DC47-4F77-91D2-2A061D2E0392"}
 */
function habilitarDia()
{
	/**@type {String}*/
	var dia = arguments[5]
	foundset.getSelectedRecord()[dia] = foundset.getSelectedRecord().cli_turno_calendario_to_medico.medico_to_agenda_parametros.age_cantidad_turnos
	databaseManager.saveData(foundset.getSelectedRecord())
}

/**
 * @properties={typeid:24,uuid:"ACD54C11-A7E0-4C1A-8076-2F60F25116B4"}
 * @AllowToRunInFind
 */
function deshabilitarDia()
{
	/**@type {String}*/
	var dia = arguments[5]
	/**@type {Array<String>}*/
	var separator = dia.split('_')
	var diaNumber = utils.stringToNumber(separator[3])	
	
	/** @type {JSFoundset<db:/sistemas/turno>}*/
	var fs_tur = databaseManager.getFoundSet('sistemas','turno')
	fs_tur.find()	
	fs_tur.turno_dia = new Date(vl_anio,vl_mes - 1,diaNumber)
	fs_tur.medico_id = foundset.getSelectedRecord().medico_id
	fs_tur.search()
	fs_tur.deleteAllRecords()
	foundset.getSelectedRecord()[dia] = 'NA'
	databaseManager.saveData(foundset.getSelectedRecord())	
}

/**
 * TODO generated, please specify type and doc for the params
 * @param dia
 * @param mes
 * @param anio
 * @param medico
 * @properties={typeid:24,uuid:"F9ECD423-6110-4EB1-B395-4A2267500C35"}
 * @AllowToRunInFind
 */
function verDiaDisponible(dia,mes,anio,medico)
{
	var fecha = new Date(anio,mes - 1,dia)
	/** @type {JSRecord<db:/sistemas/agenda_excepciones>}*/	
	var fs_exp = databaseManager.getFoundSet('sistemas','agenda_excepciones')
	fs_exp.find()
	fs_exp.excep_fecha = fecha
	fs_exp.medico_id = medico
	var cant = fs_exp.search()
	if(cant <= 0)
	{
		fs_exp.find()
		fs_exp.excep_fecha = fecha
		fs_exp.medico_id = 0
		cant = fs_exp.search()
		if(cant > 0)
		{		
			return fs_exp.excep_mascara
		}
	}
	else
	{
		return fs_exp.excep_mascara
	}
	/** @type {JSRecord<db:/sistemas/agenda_parametros>}*/	
	var fs_par = databaseManager.getFoundSet('sistemas','agenda_parametros')
	fs_par.find()
	fs_par.medico_id = medico
	cant = fs_par.search()
	if(cant > 0)
	{
		switch (fecha.getDay()) 
		{
		case 0:
		if(fs_par.age_domingo == 0)
		{
			return 'NA'
		}
		break;			
		case 1:
		if(fs_par.age_lunes == 0)
		{
			return 'NA'
		}			
		break;
		case 2:
		if(fs_par.age_martes == 0)
		{
			return 'NA'
		}			
		break;
		case 3:
		if(fs_par.age_miercoles == 0)
		{
			return 'NA'
		}			
		break;
		case 4:
		if(fs_par.age_jueves == 0)
		{
			return 'NA'
		}		
		break;
		case 5:
		if(fs_par.age_viernes == 0)
		{
			return 'NA'
		}		
		break;
		case 6:
		if(fs_par.age_sabado == 0)
		{
			return 'NA'
		}		
		break;
		}
		
	}
	if(fs_par.age_cantidad_turnos == null)
	{
		fs_par.age_cantidad_turnos = forms.cli_turnos_auxiliar.calcularCantTurnoXDia(medico,fecha)
	}
	
	return (utils.numberFormat(fs_par.age_cantidad_turnos,'#'))
}
/**
 * Perform the element right-click action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"5A346532-C27B-4E17-B601-93A6B169B335"}
 */
function onRightClickMenuGral(event) 
{
	var menu = plugins.window.createPopupMenu();

	menu.addMenuItem("Eliminar Registro",eliminarRegDoctor,"media:///16x16/document_red.png",null);
	menu.show()
}


/**
 * @properties={typeid:24,uuid:"3C8AF3D0-ECA2-49B3-813A-E6B9431CC8E5"}
 */
function eliminarRegDoctor()
{
	foundset.getSelectedRecord().cli_turno_calendario_to_turno.deleteAllRecords()
	foundset.deleteRecord(foundset.getSelectedRecord())

}

/**
 * Perform the element default action.
 *
 * @param {JSEvent} event the event that triggered the action
 *
 * @properties={typeid:24,uuid:"AABC2120-535B-476F-ACCC-45F3BFB19256"}
 */
function onActionGeneralPlanilla(event) 
{
	if (application.getApplicationType() == APPLICATION_TYPES.WEB_CLIENT) {
	    plugins.busy.prepare();
	}
	var params = {
		processFunction: generarPlanilla,
		message: 'Generando Planilla... espere un momento por favor.',
		opacity: 0.5,
		paneColor: '#000000',
		showCancelButton: false,
		cancelButtonText: 'Stop!'
	};
	plugins.busy.block(params);

}
